{"file":"/Users/kimnaciscionis/git/personal/seb-exchange-rates/src/plugins/knex-plugin.ts","mappings":";;;;;AACA,oEAAgC;AAChC,6BAA8B;AAO9B,MAAM,UAAU,GAAG,KAAK,EAAE,OAAwB,EAAE,OAAY,EAAE,EAAE;IACnE,+CAA+C;IAC/C,uDAAuD;IACvD,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;IAC3B,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAE/B,OAAO,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,IAAI,EAAE;QACrC,MAAM,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IAC9B,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,kBAAe,IAAA,wBAAE,EAAC,UAAU,EAAE;IAC7B,IAAI,EAAE,MAAM;CACZ,CAAC,CAAC","names":[],"sources":["/Users/kimnaciscionis/git/personal/seb-exchange-rates/src/plugins/knex-plugin.ts"],"sourcesContent":["import { FastifyInstance } from \"fastify\";\nimport fp from \"fastify-plugin\";\nimport Knex = require(\"knex\");\n\ndeclare module \"fastify\" {\n\tinterface FastifyInstance {\n\t\tknex: Knex.Knex;\n\t}\n}\nconst knexPlugin = async (fastify: FastifyInstance, options: any) => {\n\t// TODO: can be configured with pool connection\n\t// const connection  = mysql.createConnection(options);\n\tconst knex = Knex(options);\n\tfastify.decorate(\"knex\", knex);\n\n\tfastify.addHook(\"onClose\", async () => {\n\t\tawait fastify.knex.destroy();\n\t});\n};\n\nexport default fp(knexPlugin, {\n\tname: \"knex\",\n});\n"],"version":3}