5ec0f8d406334bd50f1454aca449b6ed
const Knex = require('knex');
const fp = require('fastify-plugin');

Knex.knex = jest.mock();

const knexPlugin = fp(async (fastify, options) => {
    console.log(options);
    const knex = { 
        raw: jest.fn(),
        destroy: jest.fn(),
        migrate: {
            latest: jest.fn(),
        },
        table: () => ({
            select: jest.fn();
        })

    }

    fastify.decorate('knex', knex);
})

jest.mock('./src/plugins/knex-plugin', (() => {
  return knexPlugin;
}));
