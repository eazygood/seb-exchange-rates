{"file":"/Users/kimnaciscionis/git/personal/seb-exchange-rates/test/helper.ts","mappings":";AAAA,iCAAiC;AACjC,mCAAmC;AACnC,gCAAgC;;;;;;AAehC,qDAA6B;AAE7B,MAAM,QAAQ,GAAG,KAAK,EAAE,OAAY,EAAE,EAAE;IACtC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IAC1C,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IACjD,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IAC5C,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IAC5C,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAA;IAC3C,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IAC1C,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;IAC3C,OAAO,CAAC,IAAI,CAAC,WAAW;QACxB,IAAI,CAAC,EAAE,CAAC,KAAK,UAAU,eAAe,CAAC,EAAE;YACrC,OAAO,EAAE,CAAC,GAAG,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AACF,MAAM,GAAG,GAAG;IACV,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,UAAS,IAAI;QACzB,OAAO,IAAI,CAAC;IAChB,CAAC,CAAC;IACF,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;CACpB,CAAC;AAEK,KAAK,UAAU,YAAY;IACjC,MAAM,GAAG,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC;IAE3C,MAAM,GAAG,CAAC,KAAK,EAAE,CAAC;IAEjB,QAAQ,CAAC,GAAG,CAAC,CAAC;IAEf,OAAO,GAAG,CAAC;AACZ,CAAC;AARD,oCAQC;AAEM,KAAK,UAAU,WAAW;IAChC,MAAM,aAAG,CAAC,KAAK,EAAE,CAAC;AACnB,CAAC;AAFD,kCAEC","names":[],"sources":["/Users/kimnaciscionis/git/personal/seb-exchange-rates/test/helper.ts"],"sourcesContent":["// import Fastify from \"fastify\";\n// import fp from \"fastify-plugin\";\n// import App from \"../src/app\";\n\n// export function build() {\n//   const app = Fastify();\n\n//   beforeAll(async () => {\n//     void app.register(fp(App));\n//     await app.ready();\n//   });\n\n//   afterAll(async () => await app.close());\n\n//   return app;\n// }\nimport { FastifyInstance } from 'fastify';\nimport app from '../src/app';\n\nconst mockKnex = async (fastify: any) => {\n  fastify.knex = jest.fn().mockReturnThis();\n  fastify.transacting = jest.fn().mockReturnThis();\n  fastify.update = jest.fn().mockReturnThis();\n  fastify.insert = jest.fn().mockReturnThis();\n  fastify.select = jest.fn().mockReturnThis()\n  fastify.from = jest.fn().mockReturnThis();\n  fastify.where = jest.fn().mockReturnThis();\n  fastify.knex.transaction = \n  jest.fn(async function mockTransaction(cb) {\n      return cb(trx);\n  });\n};\nconst trx = {\n  commit: jest.fn(function(data) {\n      return data;\n  }),\n  rollback: jest.fn(),\n};\n\nexport async function startTestEnv(): Promise<FastifyInstance> {\n\tconst app = require('..//src/app').default;\n\n\tawait app.ready();\n\n  mockKnex(app);\n\n\treturn app;\n}\n\nexport async function stopTestEnv(): Promise<void> {\n\tawait app.close();\n}\n\n"],"version":3}