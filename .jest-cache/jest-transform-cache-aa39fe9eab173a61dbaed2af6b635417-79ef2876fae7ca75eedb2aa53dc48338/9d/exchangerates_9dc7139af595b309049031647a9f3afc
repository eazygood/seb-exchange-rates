038218e9f02d4f088e7c2843483027e1
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getExchangeRatesCurrencies = exports.getExchangeRatesByCurrency = exports.getExchangeRates = void 0;
const entities_1 = require("../../entities");
const fxrate_manager_1 = require("../../managers/fxrate-manager");
const currencies_repository_1 = require("../../repositories/currencies-repository");
exports.getExchangeRates = {
    method: "GET",
    url: "/exchange-rates",
    schema: {
        querystring: entities_1.ExchangeRatesQuerySchema,
    },
    async handler(req, reply) {
        const fxRates = await (0, fxrate_manager_1.getFxRates)(req.server, req.query.latest);
        reply.code(200).send({ data: fxRates, size: fxRates.length });
    },
};
exports.getExchangeRatesByCurrency = {
    method: "GET",
    url: "/exchange-rates/:currency",
    schema: {
        params: entities_1.ExchangeRateCurrencyParamSchema,
    },
    async handler(req, reply) {
        if (!req.params.currency) {
            return reply.code(404).send({ data: [], status: false });
        }
        const fxRates = await (0, fxrate_manager_1.getFxRatesByCurrency)(req.server, req.params.currency);
        reply.code(200).send({ data: fxRates, size: fxRates.length });
    },
};
exports.getExchangeRatesCurrencies = {
    method: "GET",
    url: "/exchange-rates/currencies",
    async handler(req, reply) {
        const currencies = await (0, currencies_repository_1.getCurrencies)(req.server);
        console.log(currencies);
        reply.code(200).send({ data: currencies });
    },
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpbW5hY2lzY2lvbmlzL2dpdC9wZXJzb25hbC9zZWItZXhjaGFuZ2UtcmF0ZXMvc3JjL3JvdXRlcy9wdWJsaWMvZXhjaGFuZ2UtcmF0ZXMudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkNBTXdCO0FBQ3hCLGtFQUd1QztBQUN2QyxvRkFBeUU7QUFFNUQsUUFBQSxnQkFBZ0IsR0FBK0M7SUFDMUUsTUFBTSxFQUFFLEtBQUs7SUFDYixHQUFHLEVBQUUsaUJBQWlCO0lBQ3RCLE1BQU0sRUFBRTtRQUNOLFdBQVcsRUFBRSxtQ0FBd0I7S0FDdEM7SUFDRCxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxLQUFLO1FBQ3RCLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSwyQkFBVSxFQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUUvRCxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7Q0FDRixDQUFDO0FBRVcsUUFBQSwwQkFBMEIsR0FFbEM7SUFDSCxNQUFNLEVBQUUsS0FBSztJQUNiLEdBQUcsRUFBRSwyQkFBMkI7SUFDaEMsTUFBTSxFQUFFO1FBQ04sTUFBTSxFQUFFLDBDQUErQjtLQUN4QztJQUNELEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEtBQUs7UUFDdEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDekIsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDM0QsQ0FBQztRQUVELE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSxxQ0FBb0IsRUFBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFNUUsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztJQUNoRSxDQUFDO0NBQ0YsQ0FBQztBQUVXLFFBQUEsMEJBQTBCLEdBQWM7SUFDbkQsTUFBTSxFQUFFLEtBQUs7SUFDYixHQUFHLEVBQUUsNEJBQTRCO0lBQ2pDLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEtBQUs7UUFDdEIsTUFBTSxVQUFVLEdBQUcsTUFBTSxJQUFBLHFDQUFhLEVBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ25ELE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUE7UUFFdkIsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUM3QyxDQUFDO0NBQ0YsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2ltbmFjaXNjaW9uaXMvZ2l0L3BlcnNvbmFsL3NlYi1leGNoYW5nZS1yYXRlcy9zcmMvcm91dGVzL3B1YmxpYy9leGNoYW5nZS1yYXRlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFeGNoYW5nZVJhdGVDdXJyZW5jeVBhcmFtLFxuICBFeGNoYW5nZVJhdGVDdXJyZW5jeVBhcmFtU2NoZW1hLFxuICBFeGNoYW5nZVJhdGVzUXVlcnksXG4gIEV4Y2hhbmdlUmF0ZXNRdWVyeVNjaGVtYSxcbiAgUm91dGUsXG59IGZyb20gXCIuLi8uLi9lbnRpdGllc1wiO1xuaW1wb3J0IHtcbiAgZ2V0RnhSYXRlcyxcbiAgZ2V0RnhSYXRlc0J5Q3VycmVuY3ksXG59IGZyb20gXCIuLi8uLi9tYW5hZ2Vycy9meHJhdGUtbWFuYWdlclwiO1xuaW1wb3J0IHsgZ2V0Q3VycmVuY2llcyB9IGZyb20gXCIuLi8uLi9yZXBvc2l0b3JpZXMvY3VycmVuY2llcy1yZXBvc2l0b3J5XCI7XG5cbmV4cG9ydCBjb25zdCBnZXRFeGNoYW5nZVJhdGVzOiBSb3V0ZTx7IFF1ZXJ5c3RyaW5nOiBFeGNoYW5nZVJhdGVzUXVlcnkgfT4gPSB7XG4gIG1ldGhvZDogXCJHRVRcIixcbiAgdXJsOiBcIi9leGNoYW5nZS1yYXRlc1wiLFxuICBzY2hlbWE6IHtcbiAgICBxdWVyeXN0cmluZzogRXhjaGFuZ2VSYXRlc1F1ZXJ5U2NoZW1hLFxuICB9LFxuICBhc3luYyBoYW5kbGVyKHJlcSwgcmVwbHkpIHtcbiAgICBjb25zdCBmeFJhdGVzID0gYXdhaXQgZ2V0RnhSYXRlcyhyZXEuc2VydmVyLCByZXEucXVlcnkubGF0ZXN0KTtcblxuICAgIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHsgZGF0YTogZnhSYXRlcywgc2l6ZTogZnhSYXRlcy5sZW5ndGggfSk7XG4gIH0sXG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RXhjaGFuZ2VSYXRlc0J5Q3VycmVuY3k6IFJvdXRlPHtcbiAgUGFyYW1zOiBFeGNoYW5nZVJhdGVDdXJyZW5jeVBhcmFtO1xufT4gPSB7XG4gIG1ldGhvZDogXCJHRVRcIixcbiAgdXJsOiBcIi9leGNoYW5nZS1yYXRlcy86Y3VycmVuY3lcIixcbiAgc2NoZW1hOiB7XG4gICAgcGFyYW1zOiBFeGNoYW5nZVJhdGVDdXJyZW5jeVBhcmFtU2NoZW1hLFxuICB9LFxuICBhc3luYyBoYW5kbGVyKHJlcSwgcmVwbHkpIHtcbiAgICBpZiAoIXJlcS5wYXJhbXMuY3VycmVuY3kpIHtcbiAgICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IGRhdGE6IFtdLCBzdGF0dXM6IGZhbHNlIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGZ4UmF0ZXMgPSBhd2FpdCBnZXRGeFJhdGVzQnlDdXJyZW5jeShyZXEuc2VydmVyLCByZXEucGFyYW1zLmN1cnJlbmN5KTtcblxuICAgIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHsgZGF0YTogZnhSYXRlcywgc2l6ZTogZnhSYXRlcy5sZW5ndGggfSk7XG4gIH0sXG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RXhjaGFuZ2VSYXRlc0N1cnJlbmNpZXM6IFJvdXRlPHt9PiA9IHtcbiAgbWV0aG9kOiBcIkdFVFwiLFxuICB1cmw6IFwiL2V4Y2hhbmdlLXJhdGVzL2N1cnJlbmNpZXNcIixcbiAgYXN5bmMgaGFuZGxlcihyZXEsIHJlcGx5KSB7XG4gICAgY29uc3QgY3VycmVuY2llcyA9IGF3YWl0IGdldEN1cnJlbmNpZXMocmVxLnNlcnZlcik7XG4gICAgY29uc29sZS5sb2coY3VycmVuY2llcylcblxuICAgIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHsgZGF0YTogY3VycmVuY2llcyB9KTtcbiAgfSxcbn07XG4iXSwidmVyc2lvbiI6M30=