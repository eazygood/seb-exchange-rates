55a1aa2cf2629eee50a0f1d8337e574f
// const knex = jest.fn();
const mysql = jest.fn();
const Knex = require('knex');
const fp = require('fastify-plugin');
Knex.knex = jest.mock();

const knexPlugin = async (fastify, options) => {
    console.log(options);
    const knex = { 
        raw: jest.fn(),
        destroy: jest.fn(),
    }

    fastify.decorate('knex', knex);
}

// jest.mock('./src/plugins/knex-plugin', (() => {
//   return knexPlugin;
// }));
const mockFp = (pluginFunction, options) => {
    // Call the plugin function with Fastify and options
    console.log('asdf', pluginFunction);
    mockFastify = {
        decorate: jest.fn()
    }
    return pluginFunction(mockFastify, options);
  };

jest.mock('./src/plugins/knex-plugin', () => ({
    __esModule: true,
    default: mockFp(knexPlugin),
}));

// knex = {
//     raw: jest.fn().mockReturnThis(),
//     destroy: jest.fn().mockReturnThis(),
// }
